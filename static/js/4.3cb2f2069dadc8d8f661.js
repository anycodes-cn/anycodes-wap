webpackJsonp([4],{gUFW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("woOf"),a=i.n(n),l=i("2sLL"),s=i("YxJB"),r=i("3Lt7"),u=(l.a,s.a,r.a,{name:"File",components:{XButton:l.a,Flexbox:s.a,FlexboxItem:r.a},data:function(){return{currentFileId:-1,currentFile:{filename:"",target:0,fileversion:"",language:"",languageversion:"",mode:"",ufid:0},targets:["rgb(255, 255, 255)","rgb(63, 81, 181)","rgb(229, 28, 35)","rgb(255, 152, 0)","rgb(37, 155, 36)","rgb(255, 64, 129)"],fileVersions:[],languages:[],languageVersions:[],preFilename:"",files:[]}},mounted:function(){this.getFileList()},activated:function(){this.getFileList()},methods:{getFileList:function(){var e=this;this.UTIL.$post(this,"filelist").then(function(t){if("200"===t.code){var i=t.res;e.files=i.data&&i.data.data}}).catch(function(t){console.log(t),e.$vux.toast.show({type:"cancel",text:"获取列表失败"})})},deleteFile:function(){var e=this;this.UTIL.$post(this,"delfile",{filename:this.currentFile.filename}).then(function(t){"200"!==t.code&&"201"!==t.code||(e.currentFileId=-1,e.getFileList())})},editFile:function(e,t){var i=this;e!==this.currentFileId?(this.currentFileId=e,this.currentFile=a()({},t,{language:t.language+"--"+t.mode}),this.preFilename=t.filename,this.UTIL.$post(this,"getfileversion",{filename:this.currentFile.filename}).then(function(e){"200"===e.code&&(i.fileVersions=e.res.data.data)}),this.UTIL.$post(this,"getlanguage").then(function(e){"200"===e.code&&(i.languages=e.res.data.data,i.selectLanguage())})):this.currentFileId=-1},selectLanguage:function(){var e=this.languages;for(var t in e)if(e[t].language+"--"+e[t].mode===this.currentFile.language){this.languageVersions=e[t].version;break}},submitChange:function(){var e=this;this.UTIL.$post(this,"edifile",{source_filename:this.preFilename,filename:this.currentFile.filename,language:this.currentFile.language.split("--")[0],languageversion:this.currentFile.languageversion,target:this.currentFile.target,version:this.currentFile.fileversion}).then(function(t){e.currentFileId=-1,e.getFileList()})},changeTag:function(e){this.currentFile.target=e},getFileCode:function(e){this.$store.commit("updateClickFile",!0),this.$store.commit("updateFileInfo",e),this.$store.commit("toggleIsChangeRoute"),this.$store.commit("updateCurrentRoute","OnlineCode"),this.$router.push("/OnlineCode")}},filters:{getFileName:function(e){return e?e.split("/").slice(-1)[0]:""},getFilePath:function(e){return e&&e.match(/^(\w+\/)*/g)[0]||"/"}}}),o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"online-code-file"},[i("ul",{staticClass:"file-list"},e._l(e.files,function(t,n){return i("li",{key:n,class:["file",e.currentFileId===n?"editing":""]},[i("div",{staticClass:"flex-box"},[i("div",{staticClass:"tag-circle",style:"background:"+e.targets[t.target]}),e._v(" "),i("div",{staticClass:"name-path"},[i("div",{staticClass:"name"},[i("span",{staticClass:"file-name",on:{click:function(i){e.getFileCode(t)}}},[e._v(e._s(e._f("getFileName")(t.filename)))])]),e._v(" "),i("div",{staticClass:"path"},[e._v("\n            "+e._s(e._f("getFilePath")(t.filename))+"\n          ")])]),e._v(" "),i("i",{staticClass:"el-icon-anycodes-edit edit-file",on:{click:function(i){e.editFile(n,t)}}})]),e._v(" "),e.currentFileId===n?i("div",{staticClass:"edit-form"},[i("div",{staticClass:"edit-form-item"},[i("span",{staticClass:"label"},[e._v("命名：")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentFile.filename,expression:"currentFile.filename"}],staticClass:"edit-input",domProps:{value:e.currentFile.filename},on:{input:function(t){t.target.composing||e.$set(e.currentFile,"filename",t.target.value)}}})]),e._v(" "),i("div",{staticClass:"edit-form-item"},[i("span",{staticClass:"label"},[e._v("标记：")]),e._v(" "),i("div",{staticClass:"edit-input edit-tag"},e._l(e.targets,function(t,n){return i("div",{key:t,class:e.currentFile.target===n?"active":"",style:"background:"+t,on:{click:function(t){e.changeTag(n)}}})}),0)]),e._v(" "),i("div",{staticClass:"edit-form-item"},[i("span",{staticClass:"label"},[e._v("时间：")]),e._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:e.currentFile.fileversion,expression:"currentFile.fileversion"}],staticClass:"edit-input",on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.currentFile,"fileversion",t.target.multiple?i:i[0])}}},e._l(e.fileVersions,function(t){return i("option",{key:t.ufid,attrs:{label:t.version},domProps:{value:t.version,selected:t.selected}},[e._v(e._s(t.version))])}),0)]),e._v(" "),i("div",{staticClass:"edit-form-item"},[i("span",{staticClass:"label"},[e._v("语言：")]),e._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:e.currentFile.language,expression:"currentFile.language"}],staticClass:"edit-input",on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.currentFile,"language",t.target.multiple?i:i[0])},e.selectLanguage]}},e._l(e.languages,function(t){return i("option",{key:t.language,attrs:{label:t.language},domProps:{value:t.language+"--"+t.mode}},[e._v(e._s(t.language))])}),0)]),e._v(" "),i("div",{staticClass:"edit-form-item"},[i("span",{staticClass:"label"},[e._v("版本：")]),e._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:e.currentFile.languageversion,expression:"currentFile.languageversion"}],staticClass:"edit-input",on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.currentFile,"languageversion",t.target.multiple?i:i[0])}}},e._l(e.languageVersions,function(t){return i("option",{key:t,attrs:{label:t},domProps:{value:t}},[e._v(e._s(t))])}),0)]),e._v(" "),i("flexbox",{staticClass:"edit-form-item buttons",staticStyle:{height:"auto","text-align":"center"},attrs:{gutter:1}},[i("flexbox-item",[i("x-button",{staticClass:"default-button",attrs:{mini:"",plain:"",type:"default"},nativeOn:{click:function(t){return e.deleteFile(t)}}},[e._v("删除")])],1),e._v(" "),i("flexbox-item",[i("x-button",{staticClass:"default-button submit-button",attrs:{mini:"",plain:"",type:"default"},nativeOn:{click:function(t){return e.submitChange(t)}}},[e._v("提交")])],1)],1)],1):e._e()])}),0)])},staticRenderFns:[]};var c=i("VU/8")(u,o,!1,function(e){i("m0Ih")},"data-v-b7bf736e",null);t.default=c.exports},m0Ih:function(e,t){}});